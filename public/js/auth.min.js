!function(e){"use strict";e(".toggle-password").click(function(){e(this).toggleClass("fa-eye fa-eye-slash");var a=e(e(this).attr("toggle"));"password"==a.attr("type")?a.attr("type","text"):a.attr("type","password")})}(jQuery);let country=[];function old_auth(){function validateLogin(){const e=Array.from(document.querySelectorAll(".validate"));let a=!0;return e.map((e,t)=>{const s=e.parentNode.childNodes[1].childNodes[3];let o=[];(o=1==t?justRequiredAndMin(s,6):justRequired(s))[0]?(s.classList.add("is-valid"),s.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,s.classList.remove("is-valid"),s.classList.add("is-invalid"),e.innerHTML=o[1])}),a}$(function(){if($("#registerAccount").length>0){function login(e,a){let t=new FormData;t.append("email",e),t.append("password",a),$.ajax({url:BASE_URL_SERVER+"/login",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t,method:"POST",dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(e,a,t){$("#error_something").html(""),e.success&&cekTokoLogin(e.data.id_user,e.data,e.token.original.token)},error:function(e,a){const t=e.responseJSON;$("#btn-submit-login").attr("disabled",!1),"invalid_credentials"==t.error?(Toast.fire({icon:"error",title:"Username atau password salah"}),$("#error_something").html("Username atau password salah")):($("#error_something").html(t.error),Toast.fire({icon:"error",title:t.error}))}})}$("#registerAccount").on("submit",function(e){if(e.preventDefault(),validateRegister()){$("#btn-register").attr("disabled",!0);let split1=$("#country_code").val().split("("),split2=split1[1].split(")"),finalSplit=split2[0],form=new FormData;form.append("email",$("#email").val()),form.append("username",$("#username").val()),form.append("city",$("#kota").val()),form.append("password",$("#password-field").val()),form.append("first_name",$("#firstName").val()),form.append("last_name",$("#lastName").val()),form.append("phone",$("#PhoneNumber").val()),form.append("postal_code",$("#postal_code").val()),form.append("country_code",finalSplit),form.append("address",$("#address").val()),form.append("role","2"),$(".blankLoad").show(),$(".blankLoad").css("display","flex"),document.body.style.overflowY="hidden",$.ajax({url:BASE_URL_SERVER+"/register",data:form,method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(e,a,t){$(".blankLoad").hide(),login(e.data.email,$("#password-field").val())},error:function(xhr,status){$(".blankLoad").hide(),$("#btn-register").attr("disabled",!1),document.body.style.overflowY="auto";const data=xhr.responseJSON.errors;if(null!=data){const keys=Object.keys(data),validation=Array.from(document.querySelectorAll(".validate"));keys.map(key=>{const value=eval("data."+key);"username"==key?validation[1].innerHTML=value[0]:"email"==key?validation[0].innerHTML=value[0]:"first_name"==key?validation[2].innerHTML=value[0]:"last_name"==key?validation[3].innerHTML=value[0]:"phone"==key?validation[4].innerHTML=value[0]:"address"==key?validation[9].innerHTML=value[0]:"city"==key?validation[6].innerHTML=value[0]:"postal_code"==key?validation[5].innerHTML=value[0]:"password"==key?validation[8].innerHTML=value[0]:"country_code"==key&&(validation[7].innerHTML=value[0])})}}})}else{const e=document.querySelector(".card-login").offsetHeight;document.querySelector(".rightCard").style.height=`${e}px`}}),$.ajax({url:"https://restcountries.eu/rest/v2/all",type:"GET",method:"GET",success:function(e){let a="";e.map(e=>{const t=`${e.name} (${e.alpha3Code})`;a+=`\n            <option value="${t}">\n          `,country=[...country,t.toLowerCase()]}),document.getElementById("datalistCountry").innerHTML=a}})}else $("#form-login").length>0?$("#form-login").on("submit",function(e){if(e.preventDefault(),validateLogin()){$("#btn-submit-login").attr("disabled",!0);let e=new FormData;e.append("email",$("#email").val()),e.append("password",$("#password-field").val()),$.ajax({url:BASE_URL_SERVER+"/login",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:e,method:"POST",dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(e,a,t){$("#error_something").html(""),e.success&&cekTokoLogin(e.data.id_user,e.data,e.token.original.token)},error:function(e,a){const t=e.responseJSON;$("#btn-submit-login").attr("disabled",!1),"invalid_credentials"==t.error?(Toast.fire({icon:"error",title:"Username atau password salah"}),$("#error_something").html("Username atau password salah")):($("#error_something").html(t.error),Toast.fire({icon:"error",title:t.error}))}})}}):$("#form-seller").length>0&&$("#form-seller").on("submit",function(e){if(e.preventDefault(),validateSeller()){$("#btn-seller").attr("disabled",!0);let logo=document.getElementById("logoToko").files[0],bg=document.getElementById("bgToko").files[0],form=new FormData;form.append("logo",logo),form.append("background",bg),form.append("nama_toko",$("#nama_toko").val()),form.append("deskripsi",$("#deskripsiToko").val()),form.append("id_user",auth.id_user),$(".blankLoad").show(),$(".blankLoad").css("display","flex"),document.body.style.overflowY="hidden",$.ajax({url:BASE_URL_SERVER+"/toko/add",data:form,method:"POST",dataType:"json",headers:{Accept:"application/json","X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content"),Authorization:"Bearer "+token},cache:!1,contentType:!1,processData:!1,success:e=>{if($(".blankLoad").hide(),"Token is Expired"==e.status&&errorToken(),e.success){const a={has_store:!0,store_data:e.data};localStorage.removeItem("store"),localStorage.setItem("store",JSON.stringify(a)),document.location.href=BASE_URL+"/toko/"+e.data.id_toko}},error:err=>{$(".blankLoad").hide(),$("#btn-seller").attr("disabled",!1);const error=err.responseJSON;if(logout(err),null!=error){const keys=Object.keys(error),validation=Array.from(document.querySelectorAll(".validation-server"));keys.map(key=>{const value=eval("error."+key);"logo"==key?validation[0].innerHTML=value[0]:"background"==key?validation[1].innerHTML=value[0]:(validation[0].innerHTML="",validation[1].innerHTML="")})}}})}})});const countryValidate=e=>{let a=[!0,"sukses"];if(""==e.value&&(a=[!1,"harus diisi"]),""!=e.value){const t=e.value.toLowerCase().split(" ");let s="";""==t[0]?t.map((e,a)=>{0!=a&&(1==a?s+=e+" ":a==t.length-1?s+=e:s+=e+" ")}):t.map((e,a)=>{0==a?s+=e+" ":a==t.length-1?s+=e:s+=e+" "}),-1==country.indexOf(s)&&(a=[!1,"Kode negara tidak valid"])}return a};function validateRegister(){const e=Array.from(document.querySelectorAll(".validate"));let a=!0;return e.map((e,t)=>{const s=e.parentNode,o=4!=t?s.childNodes[1]:s.childNodes[1].childNodes[1];if(0==t){const t=validateEmail(o);t[0]?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.add("is-invalid"),o.classList.remove("is-valid"),e.innerHTML=t[1])}else if(1==t){const t=validateUsername(o);t[0]?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.add("is-invalid"),o.classList.remove("is-valid"),e.innerHTML=t[1])}else if(7==t){const t=countryValidate(o);t[0]?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.add("is-invalid"),o.classList.remove("is-valid"),e.innerHTML=t[1])}else{const t=justRequired(o);t[0]?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.add("is-invalid"),o.classList.remove("is-valid"),e.innerHTML=t[1])}}),a}function validateSeller(){const e=Array.from(document.querySelectorAll(".validate"));let a=!0;return e.map((e,t)=>{const s=e.parentNode;let o="";if(o=1==t||2==t?s.childNodes[3]:s.childNodes[1],0==t){const t=justRequiredAndMin(o,6);t[0]?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.remove("is-valid"),o.classList.add("is-invalid"),e.innerHTML=t[1])}else if(1==t||2==t){o.files.length>0?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.remove("is-valid"),o.classList.add("is-invalid"),e.innerHTML="Pilih Gambar")}else{const t=justRequired(o);t[0]?(o.classList.add("is-valid"),o.classList.remove("is-invalid"),e.innerHTML=""):(a=!1,o.classList.remove("is-valid"),o.classList.add("is-invalid"),e.innerHTML=t[1])}}),a}function validateEmail(e){let a=[!1,"harus diisi"];return""!=e.value?a=[!0,"Sukses"]:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e.value)&&(a=[!1,"email tidak valid"]),a}function validateUsername(e){let a=[!0,"sukses"];return""==e.value?a=[!1,"Harus diisi"]:/^[a-zA-Z]+[a-zA-Z0-9-]*$/.test(e.value)||(a=[!1,"username tidak boleh ada spasi"]),a}function justRequired(e){let a=[!0,"sukses"];return""==e.value&&(a=[!1,"Harus diisi"]),a}function justRequiredAndMin(e,a){let t=[!0,"sukses"];return""==e.value?t=[!1,"Harus diisi"]:e.value.length<a&&(t=[!1,`Minimal ${a} karakter`]),t}function cekToko(e){$.ajax({url:BASE_URL_SERVER+"/cektoko/"+e+"?id_user="+e,type:"GET",success:e=>{e.success&&"Data found."==e.message&&(document.location.href=BASE_URL+"/toko/"+e.data[0].id_toko)},error:e=>{console.log(e)}})}function cekTokoLogin(e,a,t){$.ajax({url:BASE_URL_SERVER+"/cektoko/"+e+"?id_user="+e,type:"GET",success:e=>{if(e.success)getTokoProduct(e.data[0].id_toko,a,t);else{const s={has_store:e.success,store_data:e.data[0],store_product:[]};localStorage.setItem("auth_session",JSON.stringify(a)),localStorage.setItem("store",JSON.stringify(s)),localStorage.setItem("token",t),1==a.role?document.location.href=BASE_URL+"/dashboard":document.location.href=BASE_URL+"/"}},error:e=>{const s={has_store:e.responseJSON.success,store_data:[]};localStorage.setItem("auth_session",JSON.stringify(a)),localStorage.setItem("store",JSON.stringify(s)),localStorage.setItem("token",t),1==a.role?document.location.href=BASE_URL+"/dashboard":document.location.href=BASE_URL+"/"}})}function getTokoProduct(e,a,t){$.ajax({url:BASE_URL_SERVER+`/produk/toko/${e}`,type:"GET",success:function(e){if(e.success){let s=[];e.data.map(e=>{s=[...s,e.id_produk]});const o={has_store:e.success,store_data:e.data[0],store_product:s};localStorage.setItem("auth_session",JSON.stringify(a)),localStorage.setItem("store",JSON.stringify(o)),localStorage.setItem("token",t),1==a.role?document.location.href=BASE_URL+"/dashboard":document.location.href=BASE_URL+"/"}else{const s={has_store:e.success,store_data:e.data[0],store_product:[]};localStorage.setItem("auth_session",JSON.stringify(a)),localStorage.setItem("store",JSON.stringify(s)),localStorage.setItem("token",t),1==a.role?document.location.href=BASE_URL+"/dashboard":document.location.href=BASE_URL+"/"}},error:function(e){const s={has_store:res.success,store_data:res.data[0],store_product:[]};localStorage.setItem("auth_session",JSON.stringify(a)),localStorage.setItem("store",JSON.stringify(s)),localStorage.setItem("token",t),1==a.role?document.location.href=BASE_URL+"/dashboard":document.location.href=BASE_URL+"/"}})}}old_auth();